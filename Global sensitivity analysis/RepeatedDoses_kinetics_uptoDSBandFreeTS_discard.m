function [T_sim, Cv_anabolites,Cv_DSB ]  = RepeatedDoses_kinetics_uptoDSBandFreeTS(theta, model_index,Control_flag)


%theta_cellular = [0.969000000000000;540.079000000000;171.262000000000;537.075000000000;6.36200000000000;126.984000000000;25.1970000000000;2319.83400000000;0.102000000000000;0.490000000000000;0.0820000000000000;0.00600000000000000;0.0190000000000000;0.872000000000000;5.73400000000000;0.813000000000000;0.933000000000000;0.597000000000000;0.846000000000000;4.56300000000000;0.0330000000000000;2.85500000000000;0.108000000000000;21.8400000000000;0.168000000000000;17.4080000000000;0.0300000000000000];

%theta_cellular_PK =[0.980860000000000;538.450690000000;171.153100000000;536.641620000000;6.70454000000000;135.995300000000;27.1384400000000;2325.15421000000;0.0890600000000000;0.521000000000000;0.114470000000000;0.310230000000000;0.0199000000000000;0.839790000000000;5.53387000000000;0.959080000000000;0.807740000000000;0.554160000000000;0.395870000000000;4.35978000000000;0.0385200000000000;2.88205000000000;0.152570000000000;21.9351600000000;0.154750000000000;17.4304600000000;0.0321300000000000];
theta_cellular_PK = theta(1:32);
[T_UPtoFreeTS,Cv_UPtoFreeTS]=RepeatedDoses_kinetics_Cellular3to10(theta_cellular_PK,model_index,Control_flag); %time span
%theta_DSB = [0.212940000000000;32.4999300000000;3.71261000000000;73.3892700000000;3.69472000000000;0.303530000000000;3.33921000000000;1.38163000000000;0.276720000000000;35.6500000000000;6.03853000000000;0.0793900000000000;1.80119000000000;10.5164600000000;151.918160000000;10.0816500000000;194.020220000000;0.121190000000000;2.80318000000000];
theta_DSB = theta(33:33+18);
[T_DSB,Cv_DSB] = RepeatedDoses_kinetics_dNTP_DSB(theta_DSB,theta_cellular_PK, model_index,Control_flag); 
Cv_DSB_q= interp1(T_DSB , Cv_DSB , T_UPtoFreeTS,  'PCHIP');
T_sim = T_UPtoFreeTS;
Cv_anabolites = Cv_UPtoFreeTS(:,5)  ;
Cv_DSB = real(Cv_DSB_q); %make sure that (end-1)th column is DSB
%save Time_Anabolites_DSB_100_weekly_control.mat  T_sim   Cv_anabolites Cv_DSB
% X= importdata('Time_Anabolites_DSB_20_EveryTheOtherDay.mat');
% plot(X(:,1),X(:,2));
end
