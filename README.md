# Integrated mechanistic pharmacokinetics/pharmacodynamics model for 5-fluorouracil (5-FU)
The code is used to implement the model in paper 'Computational analysis of 5-fluorouracil anti-tumor activity in
colon cancer using a mechanistic
pharmacokinetic/pharmacodynamic model' which is accepted for publication in PLOS Compuatational Biology. 
Author: Chenhui Ma1, Alex Almasan, Evren Gurkan-Cavusoglu


The entire model is composed of PK, cellular, and tumor growth inhibition (TGI) sub-models (shown in figures below), the last two of which constitute the PD model. The PK model is used to compute the concentration-time profile, and the TGI model focuses on the kinetics of tumor growth post-treatment.

<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z94b3uj30gl05fgln.jpg" alt="PK" style="zoom:33%;" />
<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z8ealyj30zo0u0acg.jpg" alt="CellularTumor" width= 700 />


## Resistance analysis
The resistance analysis is discussed in detail in the manucript. The main functions in the folder are for resistance analysis are @Resistance_main_oncluster.m and Resistance_main_plot.m, which run on the cluster using Matlab Parallel computing to save extensive computational time. @Resistance_main_oncluster.m is served to execute the seven scenarios. For each scenario, based on the sampled N parameter sets, the N time courses of tumor volume, anabolites and DSBs are computed and stored, which are futhered processed and dispalyed in Fig 5, which is generated by function @Resistance_main_plot.m. The rest of the functions in the folder are called by the two main functions. Their associated roles are indicated by their function names.

## Parameter estimation: Gradient-based optimization
We first applied gradient-based optimization to preliminarily identify the optimal values of the model parameter to gain a general idea about the magnitudes of the parameters. Such useful information allows us to assign prior distribution to each parameter before conducting the MCMC analysis. Functions for estimating parameters for each submodel are included. The main functions are kinetics_dNTP_main.m kinetics_DSB_main.m kinetics_PKand3to10_main.m kinetics_TumorVolume_main.m. kinetics5_para_estimation.m called the `fmincon` function to search for the local minimizers and configured a GlobalSearch object contains properties that affect how `run` repeatedly runs a local solver to generate a GlobalOptimSolution object. We conducted the sequential parameter estimation because it is computationally infeasible to estimate all the parameters once and all.

## parameter estimation: MCMC
We utilized the Bayesian inference method to estimate the expected values of the model parameters as the Bayesian inference can capture the uncertainty of model parameters given the experimental data. We used the Robust adaptive Metropolis algorithm(RAM) in place of the naïve MH algorithm.  Specifically, the Markov chain Monte Carlo (MCMC) technique is applied to obtain the approximated expected values. MCMC_main_dNTP_DSB.m, MCMC_main_PK.m, and MCMC_main_TGI.m are the main functions for conducting MCMC analysis for the three submodels. The RAM is defined in the function MyRAM.m. The joint posterior distributions for the parameters defined in the three submodels are provided in the files, @Target_fun_LE_Cellular, @Target_fun_LE_dNTP_DSB, @Target_fun_LE_PK , and @Target_fun_LE_TGI.

## Plot Fig 2,3,4
We plotted the mean time courses of model variables defined in the PK, cellular, and nine TGI models, and associated 0.7 credible regions of model simulations based on samples generated by MCMC analysis. The main scripts are @MyStaAnalysis_Cellular, @MyStaAnalysis_PK, and @PlotAllTGI. The functions for plotting time courses and MCMC analysis are organized into the folder 'MCMC_Plot234_Ea_EDSB'. 

## Model generalizability, AUC calculation, plots of E_a(t) and E_DSB(t)
The functions @DoseDifference main and @Dose_difference_AUCe_damage, which are in the same folder as MCMC analysis, were used to carry out the three tasks.

## Sensitivity Analysis

The global sensitivity analysis is conducted by applying Morris screening and Sobol analysis.

## New dosing regimens.

We computationally experiment dosage regimens that are different from Table3. 

## TimeCourses_DSB_Anabolites
The folder named as "TimeCourses_DSB_Anabolites" includes the precomputed time courses of DSB and 5-FU anabolites using the predefined cellular model for each of nine TGI models to speed up the process of estimating parameters in TGI models.

## MCMC_Tumor_UniformPriorDist, MCMC_Cellular_UniformPriorDist, MCMC_dNTP_DSB_UniformPriorDist, 
We also employed the MCMC technique with uniform prior distributions.

## Data
The data used in the analysis are from the literature as cited in the paper. These papers are also listed below:
### Literature data used in cellular model
[1] Berne MH, Gustavsson BG, Almersj ̈o O, Spears PC, Fr ̈osing R. Sequential Methotrexate/5-FU: FdUMP Formation and TS Inhibition in a Transplantable Rodent Colon Adenocarcinoma;16(3):237–242. doi:10.1007/BF00293984.  <br> 
[2] Falzacappa MVV, Ronchini C, Faretta M, Iacobucci I, Di Ror`a AGL, Martinelli G, et al. The Combination of the PARP Inhibitor Rucaparib and 5FU Is an  
Effective Strategy for Treating Acute Leukemias;14(4):889–898. doi:10.1158/1535-7163.MCT-14-0276.   <br> 
[3] Adams ER, Leffert JJ, Craig DJ, Spector T, Pizzorno G. In Vivo Effect of 5-Ethynyluracil on 5-Fluorouracil Metabolism Determined by 19F Nuclear Magnetic Resonance Spectroscopy;59(1):122–127.  <br> 
[4] Adams ER, Leffert JJ, Craig DJ, Spector T, Pizzorno G. In Vivo Effect of 5-Ethynyluracil on 5-Fluorouracil Metabolism Determined by 19F Nuclear Magnetic Resonance Spectroscopy;59(1):122–127.  <br> 
[5] van Laar JA, van der Wilt CL, Rustum YM, Noordhuis P, Smid K, Pinedo HM, et al. Therapeutic Efficacy of Fluoropyrimidines Depends on the Duration of Thymidylate Synthase Inhibition in the Murine Colon 26-B Carcinoma Tumor Model;2(8):1327–1333. <br> 
[6] Noordhuis P, Holwerda U, Van Laar JaM, Van der Wilt CL, Peters GJ. A Non-Radioactive Sensitive Assay to Measure 5-Fluorouracil Incorporation into DNA of Solid Tumors;23(8-9):1481–1484. doi:10.1081/NCN-200027699.  <br> 
[7] Spears CP, Shahinian AH, Moran RG, Heidelberger C, Corbett TH. In Vivo Kinetics of Thymidylate Synthetase Inhibition of 5-Fluorouracil-Sensitive and -Resistant Murine Colon Adenocarcinomas;42(2):450–456.  <br> 
[8] Tattersall MH, Harrap KR. Changes in the Deoxyribonucleoside Triphosphate Pools of Mouse 5178Y Lymphoma Cells Following Exposure to Methotrexate or 5-Fluorouracil;33(12):3086–3090.  <br> 

### Literature data used in TGI model
[1] Nadal JC, van Groeningen CJ, Pinedo HM, Peters GJ. Schedule-Dependency of in Vivo Modulation of 5-Fluorouracil by Leucovorin and Uridine in Murine Colon Carcinoma;7(2-3):163–172. doi:10.1007/BF00170853.
[2] Tamaki T, Naomoto Y, Kimura S, Kawashima R, Shirakawa Y, Shigemitsu K, et al. Apoptosis in Normal Tissues Induced by Anti-Cancer Drugs. 2003 Jan-Feb;31(1):6–16. doi:10.1177/147323000303100102. 
[3] Liang B, Shahbaz M, Wang Y, Gao H, Fang R, Niu Z, et al. Integrin6-Targeted Immunoliposomes Mediate Tumor-Specific Drug Delivery and Enhance Therapeutic Efficacy in Colon Carcinoma;21(5):1183–1195. doi:10.1158/1078-0432.CCR-14-1194. 
[4] Xu L, Cheng G, Lu Y, Wang S. An Active Molecule from Pulsatilla Chinensis, Pulsatilla Saponin A, Induces Apoptosis and Inhibits Tumor Growth of Human Colon Cancer Cells without or with 5-FU;13(5):3799–3802. doi:10.3892/ol.2017.5884. 1158
[5] Iwama T, Fujiya M, Konishi H, Tanaka H, Murakami Y, Kunogi T, et al. Bacteria-Derived Ferrichrome Inhibits Tumor Progression in Sporadic Colorectal Neoplasms and Colitis-Associated Cancer;21(1):21. doi:10.1186/s12935-020-01723-9. 1162
[6] Yan Y, Lin HW, Zhuang ZN, Li M, Guo S. Interleukin-1 Receptor Antagonist Enhances Chemosensitivity to Fluorouracil in Treatment of Kras Mutant Colon Cancer;12(8):877–892. doi:10.4251/wjgo.v12.i8.877. 1165
[7] Gao Y, Xiao X, Zhang C, Yu W, Guo W, Zhang Z, et al. Melatonin Synergizes the Chemotherapeutic Effect of 5-Fluorouracil in Colon Cancer by Suppressing PI3K/AKT and NF-B/iNOS Signaling Pathways;62(2). doi:10.1111/jpi.12380.
[8] Lee JH, Lee SW. Enhancement of Chemosensitivity in 5-Fluorouracil-Resistant Colon Cancer Cells with Carcinoembryonic Antigen-Specific RNA Aptamer;46(4):3835–3842. doi:10.1007/s11033-019-04826-3.
