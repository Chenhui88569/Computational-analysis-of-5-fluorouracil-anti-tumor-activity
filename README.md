# Computational-analysis-of-5-fluorouracil-anti-tumor-activity
The entire model is composed of PK, cellular, and tumor growth inhibition (TGI) sub-models (shown in figures below), the last two of which constitute the PD model. The PK model is used to compute the concentration-time profile, and the TGI model focuses on the kinetics of tumor growth post-treatment.

<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z94b3uj30gl05fgln.jpg" alt="PK" style="zoom:33%;" />
<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z8ealyj30zo0u0acg.jpg" alt="CellularTumor" width= 700 />


## Resistance analysis
The resistance analysis is discussed in detail in the manucript. The main functions in the folder are for resistance analysis are @Resistance_main_oncluster.m and Resistance_main_plot.m, which run on the cluster using Matlab Parallel computing to save extensive computational time. @Resistance_main_oncluster.m is served to execute the seven scenarios. For each scenario, based on the sampled N parameter sets, the N time courses of tumor volume, anabolites and DSBs are computed and stored, which are futhered processed and dispalyed in Fig 5, which is generated by function @Resistance_main_plot.m. The rest of the functions in the folder are called by the two main functions. Their associated roles are indicated by their function names.

## Parameter estimation: Gradient-based optimization
We first applied gradient-based optimization to preliminarily identify the optimal values of the model parameter to gain a general idea about the magnitudes of the parameters. Such useful information allows us to assign prior distribution to each parameter before conducting the MCMC analysis. Functions for estimating parameters for each submodel are included. The main functions are kinetics_dNTP_main.m kinetics_DSB_main.m kinetics_PKand3to10_main.m kinetics_TumorVolume_main.m. kinetics5_para_estimation.m called the `fmincon` function to search for the local minimizers and configured a GlobalSearch object contains properties that affect how `run` repeatedly runs a local solver to generate a GlobalOptimSolution object. We conducted the sequential parameter estimation because it is computationally infeasible to estimate all the parameters once and all.

## parameter estimation: MCMC
We utilized the Bayesian inference method to estimate the expected values of the model parameters as the Bayesian inference can capture the uncertainty of model parameters given the experimental data. We used the Robust adaptive Metropolis algorithm(RAM) in place of the na√Øve MH algorithm.  Specifically, the Markov chain Monte Carlo (MCMC) technique is applied to obtain the approximated expected values. MCMC_main_dNTP_DSB.m, MCMC_main_PK.m, and MCMC_main_TGI.m are the main functions for conducting MCMC analysis for the three submodels. The RAM is defined in the function MyRAM.m. The joint posterior distributions for the parameters defined in the three submodels are provided in the files, @Target_fun_LE_Cellular, @Target_fun_LE_dNTP_DSB, @Target_fun_LE_PK , and @Target_fun_LE_TGI.

## Plot Fig 2,3,4
We used Matlab to plot the time courses of variables defined in the PK, cellular, and nine TGI models, which are performed together with the statistical analysis of samples generated by MCMC analysis. The main scripts are @MyStaAnalysis_Cellular, @MyStaAnalysis_PK, and @PlotAllTGI. The functions for plotting time courses and MCMC analysis are organized into the shared folders. 

## Model generalizability, AUC calculation, plots of E_a(t) and E_DSB(t)
The functions @DoseDifference main and @Dose_difference_AUCe_damage were used to carry out the three tasks.

## Sensitivity Analysis

The global sensitivity analysis is conducted by Morris screening and Sobol analysis.

## New dosing regimens.

We computationally experiment dosage regimens that are different from Table3. 

## TimeCourses_DSB_Anabolites
The folder includes the precomputed time courses of DSB and 5-FU anabolites using the predefined cellular model for each of nine TGI models to speed up the process of estimating parameters in TGI models.
