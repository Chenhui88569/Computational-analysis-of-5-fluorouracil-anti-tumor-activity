# Computational-analysis-of-5-fluorouracil-anti-tumor-activity
The entire model is composed of PK, cellular, and tumor growth inhibition (TGI) sub-models (shown in figures below), the last two of which constitute the PD model. The PK model is used to compute the concentration-time profile, and the TGI model focuses on the kinetics of tumor growth post-treatment.

<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z94b3uj30gl05fgln.jpg" alt="PK" style="zoom:33%;" />
<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyw1z8ealyj30zo0u0acg.jpg" alt="CellularTumor" width= 700 />


## Resistance analysis
The resistance analysis is discussed in detail in the manucript. The main functions in the folder are for resistance analysis are @Resistance_main_oncluster.m and Resistance_main_plot.m, which run on the cluster using Matlab Parallel computing to save extensive computational time. @Resistance_main_oncluster.m is served to execute the seven scenarios. For each scenario, based on the sampled N parameter sets, the N time courses of tumor volume, anabolites and DSBs are computed and stored, which are futhered processed and dispalyed in Fig 5, which is generated by function @Resistance_main_plot.m. The rest of the functions in the folder are called by the two main functions. Their associated roles are indicated by their function names.
  
## Parameter estimation: Gradient-based optimization
We first applied the gradient-based optimization to preliminarily identify the optimal values of the model parameter to gain a general idea about the magnitudes of the parameters. Such useful information allows us to assign prior distribution to each parameter before conducting the MCMC analysis. Functions for estimating parameters for each submodel are included. The main functions are kinetics_dNTP_main.m kinetics_DSB_main.m kinetics_PKand3to10_main.m kinetics_TumorVolume_main.m. kinetics5_para_estimation.m called the `fmincon` function to search for the local minimizers and configured a GlobalSearch object contains properties that affect how run repeatedly runs a local solver to generate a GlobalOptimSolution object. We conducted the sequential parameter estimation because it is computationally infeasible to estimate all the parameters once and all.

## parameter estimation: MCMC
We utilized the Bayesian inference method to estimate the expected values of the model parameters as the Bayesian inference can capture the uncertainty of model parameters given the experimental data. We used the Robust adaptive Metropolis algorithm(RAM) in place of the na√Øve MH algorithm. Specifically, the Markov chain Monte Carlo (MCMC) technique is applied to obtain the approximated expected values. MCMC_main_dNTP_DSB.m, MCMC_main_PK.m, and MCMC_main_TGI.m are the main functions for conducting MCMC analysis for the three submodels. The RAM is defined in function MyRAM.m. The joint posterior distributions for the parameters defined in the three submodels are provided in the files, @Target_fun_LE_Cellular, @Target_fun_LE_dNTP_DSB, @Target_fun_LE_PK ,and @Target_fun_LE_TGI.

## Plot Fig 2,3,4
We used Matlab to plot the time courses of variables defined in the PK, celluar and TGI model, which are performed 
Functions for plotting the figures in which  are put in the paper. The scripts are @PlotAllIntermediates.m, @PlotAllTGIModels.m, and @PlotMutIDose_DSB_Ana.m

## Model generalizability, Sensitivity Analysis, and AUC calculation
The main function is @DoseDifference main.m used to carry out the three tasks.
## TimeCourses_DSB_Anabolites
The folder includes the precomputed time courses of DSB and 5-FU anabolites using predefined cellular model for each of nine TGI models to speed up the process of estimating parameters in TGI models.
